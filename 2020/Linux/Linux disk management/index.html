<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="十二的编程笔记" href="https://blog.twelveeee.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="十二的编程笔记" href="https://blog.twelveeee.top/atom.xml"><link rel="alternate" type="application/json" title="十二的编程笔记" href="https://blog.twelveeee.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Linux"><link rel="canonical" href="https://blog.twelveeee.top/2020/Linux/Linux%20disk%20management/"><title>Linux 磁盘管理 - Linux 基础 - 计算机科学 | Twelveeee = 十二的编程笔记 = hello world</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Linux 磁盘管理</h1><div class="meta"><span class="item" title="创建时间：2020-05-29 15:49:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2020-05-29T15:49:00+08:00">2020-05-29</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>6.6k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>6 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Twelveeee</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_90.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_2.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_6.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_33.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_45.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_16.webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computerScience/" itemprop="item" rel="index" title="分类于 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computerScience/Linux%E5%9F%BA%E7%A1%80/" itemprop="item" rel="index" title="分类于 Linux 基础"><span itemprop="name">Linux 基础</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.twelveeee.top/2020/Linux/Linux%20disk%20management/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Twelveeee"><meta itemprop="description" content="hello world, 十二的编程笔记"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="十二的编程笔记"></span><div class="body md" itemprop="articleBody"><h1 id="7linux磁盘管理"><a class="anchor" href="#7linux磁盘管理">#</a> 7.Linux 磁盘管理</h1><h2 id="1linux物理设备介绍"><a class="anchor" href="#1linux物理设备介绍">#</a> 1.Linux 物理设备介绍</h2><p><strong>1.1 一切从 “/” 开始</strong><br>在 Linux 系统中，目录、字符设备、块设备、套接字、打印机等都被抽象成了文件，既然平时我们打交道的都是文件，那么又应该如何找到它们呢？<br>在 Linux 系统中并不存在 C/D/E/F 等盘符，Linux 系统中的一切文件都是从 “根（ / ）” 目录开始的，并按照文件系统层次化标准（FHS）采用树形结构来存放文件，以及定义了常见目录的用途。<br>另外，Linux 系统中的文件和目录名称是严格区分大小写的。例如，root、rOOt、Root、rooT 均代表不同的目录，并且文件名称中不得包含斜杠（ / ）。<br><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529164004729.png" alt="image-20200529164004729"></p><p><strong>1.2 物理设备的命名规则</strong><br>在 Linux 系统中一切都是文件，硬件设备也不例外。既然是文件，就必须有文件名称。系统内核中的 udev 设备管理器会自动把硬件名称规范起来，目的是让用户通过设备文件的名字可以猜出设备大致的属性以及分区信息等。另外，udev 设备管理器的服务会一直以守护进程的形式运行并侦听内核发出的信号来管理 /dev 目录下的设备文件。</p><table><thead><tr><th>硬件设备</th><th>文件名称</th></tr></thead><tbody><tr><td>IDE 设备</td><td>/dev/hd[a-d]</td></tr><tr><td>SCSI/SATA/U 盘</td><td>/dev/sd[a-p]</td></tr><tr><td>软驱</td><td>/dev/fd[0-1]</td></tr><tr><td>打印机</td><td>/dev/lp[0-15]</td></tr><tr><td>光驱</td><td>/dev/cdrom</td></tr><tr><td>鼠标</td><td>/dev/mouse</td></tr></tbody></table><p>由于现在的 IDE 设备已经很少见了，所以一般的硬盘设备都会是以 “/dev/sd” 开头的。而一台主机上可以有多块硬盘，因此系统采用 a～p 来代表 16 块不同的硬盘（默认从 a 开始分配），而且硬盘的分区编号也很有讲究：主分区或扩展分区的编号从 1 开始，到 4 结束；逻辑分区从编号 5 开始。</p><p><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529164208420.png" alt="image-20200529164208420"></p><p><strong>1.3 文件系统与数据资料</strong><br>用户在硬件存储设备中执行的文件建立、写入、读取、修改、转存与控制等操作都是依靠文件系统来完成的。常见的文件系统有 ext3、ext4、xfs 等。<br><strong>Ext3</strong>：是一款日志文件系统，能够在系统异常宕机时避免文件系统资料丢失，并能自动修复数据的不一致与错误。<br><strong>Ext4</strong>：Ext3 的改进版本，作为 RHEL 6 系统中的默认文件管理系统，它支持的存储容量高达 1EB（1EB=1,073,741,824GB），且能够有无限多的子目录<br><strong>XFS</strong>：是一种高性能的日志文件系统，而且是 RHEL 7 中默认的文件管理系统，它的优势在发生意外宕机后尤其明显，即可以快速地恢复可能被破坏的文件，而且强大的日志功能只用花费极低的计算和存储性能。</p><h2 id="2挂载硬件设备"><a class="anchor" href="#2挂载硬件设备">#</a> 2. 挂载硬件设备</h2><p><strong>2.1 硬件设备文件介绍</strong><br>当用户需要使用硬盘设备或分区中的数据时，需要先将其与一个已存在的目录文件进行关联，而这个关联动作就是 “挂载”。而硬盘设备或者分区如何表示呢？在 Linux 的 /dev 目录中放置的就是我们的设备文件。常见的硬件设备文件如下：<br>/dev/sda 第 1 个 SCSI 磁盘 (整个磁盘)<br>/dev/sda1 第 1 个 SCSI 磁盘的第一个分区<br>/dev/sdb 第 2 个 SCSI 磁盘 (整个磁盘)<br>/dev/sda1 第 2 个 SCSI 磁盘的第一个分区<br>/dev/cdrom 光盘<br>/dev/sr0 光盘</p><p><strong>2.2 挂载硬件设备</strong><br><strong>mount 命令</strong><br>用于挂载文件系统，只需使用 mount 命令把硬盘设备或分区与一个目录文件进行关联，然后就能在这个目录中看到硬件设备中的数据了。对于比较新的 Linux 系统来讲，一般不需要使用 - t 参数来指定文件系统的类型，Linux 系统会自动进行判断。<br>命令格式： <code>mount [-t 文件系统类型] 设备文件 挂载目录</code><br>常用选项：<br>-a 挂载所有在 /etc/fstab 中定义的文件系统<br>- t 指定文件系统的类型<br>实例：<br>把设备 /dev/cdrom 挂载到 /backup 目录<br><code>#mount -t iso9660 /dev/cdrom /backup</code></p><p>执行 mount 命令后就能立即使用文件系统了，但系统在重启后挂载就会失效，也就是说我们需要每次开机后都手动挂载一下。<br>如果想让硬件设备和目录永久地进行自动关联，就必须把挂载信息按照指定的填写格式 “<em>设备文件 挂载目录 格式类型 权限选项 是否备份 是否自检</em>” 写入到 /etc/fstab 文件中。 /etc/fstab 文件中包含着挂载所需的诸多信息项目，一旦配置好之后就能开机自动挂载了<br><code>/dev/sdb1 /newdisk xfs defaults 0 0</code><br>设备文件 挂载目录 格式类型 权限选项 是否备份 是否自检</p><table><thead><tr><th>字段</th><th>意义</th></tr></thead><tbody><tr><td>设备文件</td><td>一般为设备的路径 + 设备名称，也可以写唯一识别码（UUID，Universally Unique Identifier）</td></tr><tr><td>挂载目录</td><td>指定要挂载到的目录，需在挂载前创建好</td></tr><tr><td>格式类型</td><td>指定文件系统的格式，比如 Ext3、Ext4、XFS、SWAP、iso9660（此为光盘设备）等</td></tr><tr><td>权限选项</td><td>若设置为 defaults，则默认权限为：rw, suid, dev, exec, auto, nouser, async</td></tr><tr><td>是否备份</td><td>若为 1 则开机后使用 dump 进行磁盘备份，为 0 则不备份</td></tr><tr><td>是否自检</td><td>若为 1 则开机后自动进行磁盘自检，为 0 则不自检</td></tr></tbody></table><p><strong>3.3 卸载硬件设备</strong><br><strong>umount 命令</strong><br>用于撤销已经挂载的设备文件。<br>命令格式： <code>umount [挂载点/设备文件]</code><br>实例：<br><code>#umount /dev/sdb2</code> 把设备 /dev/sdb2 从 /backup 目录卸载掉<br>或者 <code>#umount /backup</code></p><h2 id="3添加硬盘设备"><a class="anchor" href="#3添加硬盘设备">#</a> 3. 添加硬盘设备</h2><p><strong>3.1 磁盘管理命令</strong><br><strong>free 命令</strong><br>查看内存使用情况，包括虚拟内存、物理内存和缓冲区<br>命令格式： <code>free [选项]</code><br>常用选项：<br>-b 以字节为单位，默认选项<br>- k 以 KB 为单位<br>- m 以 MB 为单位</p><p><strong>du 命令</strong><br>显示目录中文件的空间大小<br>命令格式： <code>du [参数] [路径名]</code><br>常用选项：<br>-m 以 MB 为单位，统计文件的容量（默认为 KB）<br>实例：<br><code>#du /etc</code> 显示 /etc 下文件的容量</p><p><strong>df 命令</strong><br>统计分区的使用情况<br>命令格式： <code>df [参数] [分区号/装载点]</code><br>常用选项：<br>-m 以 MB 为单位，统计使用情况<br>实例：<br><code>#df</code> 显示当前所有已装载的分区使用情况<br><code>#df /home</code> 显示 /home 分区的使用情况</p><p><strong>3.2 添加硬盘设备</strong><br>首先需要在虚拟机中模拟添加入一块新的硬盘存储设备，然后再进行分区、格式化、挂载等操作，最后通过检查系统的挂载状态并真实地使用硬盘来验证硬盘设备是否成功添加。我们不需要为了做这个实验而特意买一块真实的硬盘，而是通过虚拟机软件进行硬件模拟，因此这再次体现出了使用虚拟机软件的好处</p><p>第 1 步：首先把虚拟机系统关机，稍等几分钟会自动返回到虚拟机管理主界面，然后单击 “编辑虚拟机设置” 选项，在弹出的界面中单击 “添加” 按钮，新增一块硬件设备。<br>第 2 步：选择想要添加的硬件类型为 “硬盘”，然后单击 “下一步” 按钮就可以了。<br>第 3 步：选择虚拟硬盘的类型为 SCSI （默认推荐），并单击 “下一步” 按钮，这样虚拟机中的设备名称过一会儿后应该为 /dev/sdb。<br>第 4 步：选中 “创建新虚拟磁盘” 单选按钮，而不是其他选项，再次单击 “下一步” 按钮。<br>第 5 步：将 “最大磁盘大小” 设置为默认的 20GB。这个数值是限制这台虚拟机所使用的最大硬盘空间，而不是立即将其填满，因此默认 20GB 就很合适了，单击 “下一步” 按钮。<br>第 6 步：设置磁盘文件的文件名和保存位置（这里采用默认设置即可，无需修改），直接单击 “完成” 按钮。<br>第 7 步：将新硬盘添加好后就可以看到设备信息了。这里不需要做任何修改，直接单击 “确认” 按钮后就可以开启虚拟机了。</p><p>在虚拟机中模拟添加了硬盘设备后就应该能看到抽象成的硬盘设备文件了。按照前文讲解的 udev 服务命名规则，第二个被识别的 SCSI 设备应该会被保存为 /dev/sdb，这个就是硬盘设备文件了，但在开始使用该硬盘之前还需要进行分区操作。<br><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529170421670.png" alt="image-20200529170421670"><br><strong>fdisk 命令</strong><br>在 Linux 系统中，管理硬盘设备最常用的方法就当属 fdisk 命令了。 fdisk 命令用于管理磁盘分区，它提供了集添加、删除、转换分区等功能于一身的 “一站式分区服务”。<br>语法格式： <code>fdisk [磁盘名称]</code><br>参数：<br>m 查看全部可用的参数<br>n 添加新的分区<br>d 删除某个分区信息<br>l 列出所有可用的分区类型<br>t 改变某个分区的类型<br>p 查看分区表信息<br>w 保存并退出</p><p>第 1 步：我们首先使用 fdisk 命令来尝试管理 /dev/sdb 硬盘设备。在看到提示信息后输入参数 p 来查看硬盘设备内已有的分区信息，其中包括了硬盘的容量大小、扇区个数等信息：<br>第 2 步：输入参数 n 尝试添加新的分区。系统会要求您是选择继续输入参数 p 来创建主分区，还是输入参数 e 来创建扩展分区。这里输入参数 p 来创建一个主分区：<br>第 3 步：在确认创建一个主分区后，系统要求您先输入主分区的编号。主分区的编号范围是 1～4，因此这里输入默认的 1 就可以了。接下来系统会提示定义起始的扇区位置，敲击回车键保留默认设置即可。系统会要求定义分区的结束扇区位置，只需要输入 + 2G 即可创建出一个容量为 2GB 的硬盘分区。<br>第 4 步：再次使用参数 p 来查看硬盘设备中的分区信息。果然就能看到一个名称为 /dev/sdb1、起始扇区位置为 2048、结束扇区位置为 4196351 的主分区了。这时候千万不要直接关闭窗口，而应该敲击参数 w 后回车，这样分区信息才是真正的写入成功啦。<br>第 5 步：在上述步骤执行完毕之后，Linux 系统会自动把这个硬盘主分区抽象成 /dev/sdb1 设备文件。我们可以使用 file 命令查看该文件的属性，如果系统并没有自动把分区信息同步给 Linux 内核，而且这种情况似乎还比较常见（但不能算作是严重的 bug）。我们可以输入 partprobe 命令手动将分区信息同步到内核，而且一般推荐连续两次执行该命令，效果会更好。如果使用这个命令都无法解决问题，那么就重启计算机。</p><p><strong>3.3 格式化硬盘设备</strong><br>如果硬件存储设备没有进行格式化，则 Linux 系统无法得知怎么在其上写入数据。因此，在对存储设备进行分区后还需要进行格式化操作。在 Linux 系统中用于格式化操作的命令是 mkfs。这条命令很有意思，因为在 Shell 终端中输入 mkfs 名后再敲击两下用于补齐命令的 Tab 键，会有如下所示的效果：<br>这个 mkfs 命令很贴心地把常用的文件系统名称用后缀的方式保存成了多个命令文件，用起来也非常简单：mkfs. 文件类型名称。<br>要格式分区为 XFS 的文件系统，则命令应为： <code>mkfs.xfs /dev/sdb1</code></p><p>终于完成了存储设备的分区和格式化操作，接下来就是要来挂载并使用存储设备了。与之相关的步骤也非常简单：首先是创建一个用于挂载设备的挂载点目录；然后使用 mount 命令将存储设备与挂载点进行关联；最后使用 df -h 命令来查看挂载状态和硬盘使用量信息。</p><h2 id="4添加交换分区"><a class="anchor" href="#4添加交换分区">#</a> 4. 添加交换分区</h2><p>SWAP（交换）分区是一种通过在硬盘中预先划分一定的空间，然后将把内存中暂时不常用的数据临时存放到硬盘中，以便腾出物理内存空间让更活跃的程序服务来使用的技术，其设计目的是为了解决真实物理内存不足的问题。但由于交换分区毕竟是通过硬盘设备读写数据的，速度肯定要比物理内存慢，所以只有当真实的物理内存耗尽后才会调用交换分区的资源。<br>交换分区的创建过程与前文讲到的挂载并使用存储设备的过程非常相似。在对 /dev/sdb 存储设备进行分区操作前，有必要先说一下交换分区的划分建议：在生产环境中，交换分区的大小一般为真实物理内存的 1.5～2 倍，为了让大家更明显地感受交换分区空间的变化，这里取出一个大小为 5GB 的主分区作为交换分区资源。在分区创建完毕后保存并退出即可：<br><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529190354858.png" alt="image-20200529190354858"></p><p>使用 SWAP 分区专用的格式化命令 mkswap，对新建的主分区进行格式化操作：<br><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529190741677.png" alt="image-20200529190741677"></p><p>使用 swapon 命令把准备好的 SWAP 分区设备正式挂载到系统中。我们可以使用 free -m 命令查看交换分区的大小变化（由 2043MB 增加到 7163MB）：<br><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529190758609.png" alt="image-20200529190758609"><br>为了能够让新的交换分区设备在重启后依然生效，需要按照下面的格式将相关信息写入到配置文件中，并记得保存：<br><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529190819525.png" alt="image-20200529190819525"></p><h2 id="5磁盘容量配额"><a class="anchor" href="#5磁盘容量配额">#</a> 5. 磁盘容量配额</h2><p><strong>5.1 磁盘配额介绍</strong><br>Linux 系统的设计初衷就是让许多人一起使用并执行各自的任务，从而成为多用户、多任务的操作系统。但是，硬件资源是固定且有限的，如果某些用户不断地在 Linux 系统上创建文件或者存放电影，硬盘空间总有一天会被占满。针对这种情况，root 管理员就需要使用磁盘容量配额服务来限制某位用户或某个用户组针对特定文件夹可以使用的最大硬盘空间或最大文件个数，一旦达到这个最大值就不再允许继续使用。<br>可以使用 quota 命令进行磁盘容量配额管理，从而限制用户的硬盘可用容量或所能创建的最大文件个数。quota 命令还有软限制和硬限制的功能。<br>软限制：当达到软限制时会提示用户，但仍允许用户在限定的额度内继续使用。<br>硬限制：当达到硬限制时会提示用户，且强制终止用户的操作</p><p><strong>5.2 磁盘容量配额设置</strong><br>磁盘容量配额设置步骤：<br>步骤一：在存储设备中开启对 quota 的支持<br>步骤二：创建检查 quota 磁盘容量配额效果的用户<br>步骤三：利用 xfs_quota 命令配置磁盘配额<br>步骤四：测试效果</p><p>步骤一、RHEL 7 系统中已经安装了 quota 磁盘容量配额服务程序包，但存储设备却默认没有开启对 quota 的支持，此时需要手动编辑配置文件，让 RHEL 7 系统中的 /boot 目录能够支持 quota 磁盘配额技术。Linux 系统要想让硬盘设备支持 quota 磁盘容量配额服务，RHEL 7 系统使用的是 uquota 参数。<br><img data-src="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/image-20200529191805732.png" alt="image-20200529191805732"></p><p>在重启系统后使用 mount 命令查看，即可发现 /boot 目录已经支持 quota 磁盘配额技术了。<br>对 EXT 系列文件系统，quota 仅能针对整个文件系统进行设计，无法对单一的目录进行磁盘配额；而在 xfs 的文件系统中，可以使用 quota 对目录进行磁盘配额，因此在进行磁盘配额前，一定要对文件系统进行检查。<br>核心必须支持 quota，centos7 默认支持 quota 功能。<br>只对一般用户有效，因为 root 拥有全部的磁盘空间。<br>若启用 SELinux 功能，不是所有的目录都能设定 quota，默认 quota 仅能对 /home 进行设定。</p><p>步骤二、接下来创建一个用于检查 quota 磁盘容量配额效果的用户 tom，并针对 /boot 目录增加其他人的写权限，保证用户能够正常写入数据<br><code>useradd xxx</code><br><code>chmod -Rf o+w /boot</code></p><p>步骤三、利用 xfs_quota 命令配置磁盘配额<br><strong>xfs_quota 命令</strong>可以配置磁盘配额<br>命令格式： <code>xfs_quota -x -c &quot;command&quot; [挂载点]</code><br>选项说明：<br>-x 专家模式，后续才可以跟 - c 选项<br>- c 后边跟命令<br>command： print 简单列出主机内文件系统的信息<br>report 后边必须跟支持 quota 的载入点，列出 quota 的项目设置</p><p>命令格式： <code>xfs_quota -x -c &quot;command&quot; [挂载点]</code><br>limit 实际限制选项（block inode name, 名字为 bsoft/bhard/isoft/ihard name）<br>timer 设置 grace time&quot;<br>设置用户 myquota1 的 block 限制值：<br><code>xfs_quota -x -c &quot;limit -u bsoft=250M bhard=300M myquota1&quot; /boot</code><br>设置用户组的 myquotagrp 的 block 限制值：<br><code>xfs_quota -x -c &quot;limit -g bsoft=950M bhard=1G myquotagrp&quot; /boot</code><br>设置 block 的 grace time ： <code>xfs_quota -x -c &quot;timer -u -b 14days&quot; /boot</code><br>查看磁盘配额： <code>xfs_quota -x -c &quot;state&quot; /boot</code></p><p><strong>利用 xfs_quota 命令配置磁盘配额</strong><br>[root@linuxprobe ~]# <code>xfs_quota -x -c 'limit bsoft=3m bhard=6m isoft=3 ihard=6 xxx' /boot</code><br>[root@linuxprobe ~]# <code>xfs_quota -x -c report /boot</code></p><p><strong>测试磁盘配额</strong><br><strong>dd</strong>：用指定大小的块拷贝一个文件，并在拷贝的同时进行指定的转换。<br>命令格式： <code>dd [option]</code><br>选项说明：<br>if = 文件名：输入文件名，缺省为标准输入<br>of = 文件名：输出文件名，缺省为标准输出<br>bs=bytes：同时设置读入 / 输出的块大小为 bytes 个字节<br>count=blocks：仅拷贝 blocks 个块，块大小等于 ibs 指定的字节数</p><p>步骤四、测试磁盘配额<br>当配置好上述的各种软硬限制后，尝试切换到这个普通用户，然后分别尝试创建一个体积为 5MB 和 8MB 的文件。可以发现，在创建 8MB 的文件时受到了系统限制</p><div class="tags"><a href="/tags/Linux/" rel="tag"><i class="ic i-tag"></i> Linux</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2025-08-05 20:50:32" itemprop="dateModified" datetime="2025-08-05T20:50:32+08:00">2025-08-05</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Twelveeee <i class="ic i-at"><em>@</em></i>十二的编程笔记</li><li class="link"><strong>本文链接：</strong> <a href="https://blog.twelveeee.top/2020/Linux/Linux%20disk%20management/" title="Linux 磁盘管理">https://blog.twelveeee.top/2020/Linux/Linux disk management/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2020/NetworkPrinciples/physical%20layer/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;twelveeee-note.oss-cn-beijing.aliyuncs.com&#x2F;Image&#x2F;img&#x2F;bgimg_64.webp" title="物理层"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 网络原理</span><h3>物理层</h3></a></div><div class="item right"><a href="/2020/DataStructure/Sort/swap%20sort/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;twelveeee-note.oss-cn-beijing.aliyuncs.com&#x2F;Image&#x2F;img&#x2F;bgimg_25.webp" title="排序"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 排序</span><h3>排序</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#7linux%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">7.Linux 磁盘管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1linux%E7%89%A9%E7%90%86%E8%AE%BE%E5%A4%87%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">1.Linux 物理设备介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E6%8C%82%E8%BD%BD%E7%A1%AC%E4%BB%B6%E8%AE%BE%E5%A4%87"><span class="toc-number">1.2.</span> <span class="toc-text">2. 挂载硬件设备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E6%B7%BB%E5%8A%A0%E7%A1%AC%E7%9B%98%E8%AE%BE%E5%A4%87"><span class="toc-number">1.3.</span> <span class="toc-text">3. 添加硬盘设备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E6%B7%BB%E5%8A%A0%E4%BA%A4%E6%8D%A2%E5%88%86%E5%8C%BA"><span class="toc-number">1.4.</span> <span class="toc-text">4. 添加交换分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E7%A3%81%E7%9B%98%E5%AE%B9%E9%87%8F%E9%85%8D%E9%A2%9D"><span class="toc-number">1.5.</span> <span class="toc-text">5. 磁盘容量配额</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2020/Linux/intro%20copy/" rel="bookmark" title="什么是操作系统">什么是操作系统</a></li><li><a href="/2020/Linux/intro/" rel="bookmark" title="什么是操作系统">什么是操作系统</a></li><li><a href="/2020/Linux/Linux%20commands%20that%20novices%20must%20master/" rel="bookmark" title="新手必须掌握的Linux命令">新手必须掌握的Linux命令</a></li><li><a href="/2020/Linux/Linux%20text%20editor/" rel="bookmark" title="Linux文本编辑器">Linux文本编辑器</a></li><li><a href="/2020/Linux/Linux%20user%20permissions/" rel="bookmark" title="Linux用户身份与文件权限">Linux用户身份与文件权限</a></li><li><a href="/2020/Linux/Daily%20maintenance%20of%20Linux/" rel="bookmark" title="Linux系统的日常运维">Linux系统的日常运维</a></li><li><a href="/2020/Linux/Linux%20system%20network%20configuration/" rel="bookmark" title="Linux系统网络配置">Linux系统网络配置</a></li><li class="active"><a href="/2020/Linux/Linux%20disk%20management/" rel="bookmark" title="Linux磁盘管理">Linux磁盘管理</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Twelveeee" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Twelveeee</p><div class="description" itemprop="description">十二的编程笔记</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">119</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">30</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">26</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R3ZWx2ZWVlZQ==" title="https:&#x2F;&#x2F;github.com&#x2F;twelveeee"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnR3ZWx2ZWVlZTEyQGdtYWlsLmNvbQ==" title="mailto:twelveeee12@gmail.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><span class="exturl" data-url="aHR0cHM6Ly93d3cudHJhdmVsbGluZ3MuY24vZ28uaHRtbA=="><i class="ic i-paper-plane"></i>开往</span></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2020/NetworkPrinciples/physical%20layer/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2020/DataStructure/Sort/swap%20sort/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Cache/" title="分类于 Cache">Cache</a></div><span><a href="/2021/Cache/Cache%20and%20database%20consistency%20issues/" title="缓存和数据库一致性问题">缓存和数据库一致性问题</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/" title="分类于 数据结构">数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/%E6%8E%92%E5%BA%8F/" title="分类于 排序">排序</a></div><span><a href="/2020/DataStructure/Sort/comparison%20of%20sorting%20methods/" title="排序方法的综合比较">排序方法的综合比较</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/C/" title="分类于 C">C</a></div><span><a href="/2020/C/C%20note/" title="C语言个人笔记">C语言个人笔记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/GO/" title="分类于 GO">GO</a></div><span><a href="/2023/Go/go%20statement/" title="Go 语句">Go 语句</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/algorithm2023/" title="分类于 算法训练 2023">算法训练 2023</a></div><span><a href="/2023/AlgorithmCamp2023/05_queue/" title="05-队列和哈希">05-队列和哈希</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/" title="分类于 数据结构">数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/%E6%8E%92%E5%BA%8F/" title="分类于 排序">排序</a></div><span><a href="/2020/DataStructure/Sort/merge%20sort/" title="归并排序">归并排序</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Linux%E5%9F%BA%E7%A1%80/" title="分类于 Linux 基础">Linux 基础</a></div><span><a href="/2020/Linux/Linux%20disk%20management/" title="Linux磁盘管理">Linux磁盘管理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/highAvailability/" title="分类于 高可用">高可用</a></div><span><a href="/2024/HighAvailability/distributed_transaction/" title="分布式事务">分布式事务</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Search/" title="分类于 Search">Search</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Search/Elasticsearch/" title="分类于 Elasticsearch">Elasticsearch</a></div><span><a href="/2021/Search/ElasticSearch/The_difference_with_mongoDB/" title="Elasticsearch 与 mongoDB 的区别">Elasticsearch 与 mongoDB 的区别</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/GO/" title="分类于 GO">GO</a></div><span><a href="/2023/Go/go%20test/" title="Go 测试">Go 测试</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Twelveeee @ Twelveeee</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">613k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">9:17</span></div><div class="beian-by"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener noreferrer">闽ICP备20004781号</a></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2020/Linux/Linux disk management/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=default,fetch"></script><script src="//fastly.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?30195a9a0f4d22cd45e9d770a10c683f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-F27X623LWT"></script><script data-pjax>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-F27X623LWT")</script>--></body></html>