<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="十二的编程笔记" href="https://blog.twelveeee.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="十二的编程笔记" href="https://blog.twelveeee.top/atom.xml"><link rel="alternate" type="application/json" title="十二的编程笔记" href="https://blog.twelveeee.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="数据结构,算法"><link rel="canonical" href="https://blog.twelveeee.top/2023/AlgorithmCamp2023/15_BigData/"><title>15 - 大规模数据场景 - 算法训练 2023 - 计算机科学 | Twelveeee = 十二的编程笔记 = hello world</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">15 - 大规模数据场景</h1><div class="meta"><span class="item" title="创建时间：2023-12-13 23:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-12-13T23:00:00+08:00">2023-12-13</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>2.9k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>3 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Twelveeee</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_57.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_52.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_59.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_96.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_93.webp"></li><li class="item" data-background-image="https://twelveeee-note.oss-cn-beijing.aliyuncs.com/Image/img/bgimg_34.webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computerScience/" itemprop="item" rel="index" title="分类于 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computerScience/algorithm2023/" itemprop="item" rel="index" title="分类于 算法训练 2023"><span itemprop="name">算法训练 2023</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.twelveeee.top/2023/AlgorithmCamp2023/15_BigData/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Twelveeee"><meta itemprop="description" content="hello world, 十二的编程笔记"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="十二的编程笔记"></span><div class="body md" itemprop="articleBody"><h1 id="大规模数据场景"><a class="anchor" href="#大规模数据场景">#</a> 大规模数据场景</h1><p>针对百万或者几十亿的数据的场景。</p><h2 id="位存储"><a class="anchor" href="#位存储">#</a> 位存储</h2><p>使用位存储，使用位存储最大的好处是占用的空间更小。</p><h3 id="1-使用4kb内存查找重复元素"><a class="anchor" href="#1-使用4kb内存查找重复元素">#</a> 1. 使用 4KB 内存查找重复元素</h3><p>题目要求：给定一个数组，包含从 1 到 N 的整数，N 最大为 32000，数组可能还有重复值，且 N 的取值不定，若只有 4KB 的内存可用，该如何打印数组中所有重复元素。</p><p>如果只有 4KB 的空间，那么只能寻址 <code>8*4*2^10</code> 位，这个值比 32000 要大的，因此我们可以创建 32000 位的位向量 (比特数组)，其中一个比特位置就代表一个整数。</p><figure class="highlight go"><figcaption data-lang="go"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">func</span> <span class="token function">printDuplicates</span><span class="token punctuation">(</span>arr <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	bitArray <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">bool</span><span class="token punctuation">,</span> <span class="token number">32001</span><span class="token punctuation">)</span> <span class="token comment">// 创建 32001 位的位向量，默认值为 false</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> num <span class="token operator">:=</span> <span class="token keyword">range</span> arr <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>		<span class="token keyword">if</span> bitArray<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token comment">// 打印重复的元素</span></pre></td></tr><tr><td data-num="7"></td><td><pre>		<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>			bitArray<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">&#125;</span> <span class="token comment">// 示例输入数组</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token function">printDuplicates</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="2-从40个亿中找到一个不存在的整数"><a class="anchor" href="#2-从40个亿中找到一个不存在的整数">#</a> 2. 从 40 个亿中找到一个不存在的整数</h3><p>判断可行性，40 亿位的数组需要占用多少内存。</p><p>4000000000/8/1000/1000 = 500MB 大约占用 500MB 内存</p><p>建立一个长度为 40 亿的位数组</p><figure class="highlight go"><figcaption data-lang="go"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">func</span> <span class="token function">generateMissingNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	<span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token number">4000000000</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>	bitArray <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">bool</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span> <span class="token comment">// 创建长度为 40 亿的位数组，默认值为 false</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token comment">// 随机填充位数组</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	rand<span class="token punctuation">.</span><span class="token function">Seed</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UnixNano</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		num <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		bitArray<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token comment">// 寻找第一个为 false 的位置</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>		<span class="token keyword">if</span> <span class="token operator">!</span>bitArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>			<span class="token keyword">return</span> i</pre></td></tr><tr><td data-num="17"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">// 如果找不到不存在的整数，返回 - 1</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	missingNumber <span class="token operator">:=</span> <span class="token function">generateMissingNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Missing number:"</span><span class="token punctuation">,</span> missingNumber<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="3-40-亿个数中找到出现两次的数"><a class="anchor" href="#3-40-亿个数中找到出现两次的数">#</a> 3. 40 亿个数中找到出现两次的数</h3><p>题目要求：32 位无符号整数的范围是 0～4 294 967 295，现在有 40 亿个无符号整数，可以使用最多 1GB 的内存，找出所有出现了两次的数。</p><p>所有出现过两次的数字，所以我们可以用两个位去标识一个数出现的次数。</p><p>可行性分析，占用空间为 <code>(2^32)/8/1000/1000*2 ≈ 1000MB</code></p><p>建立一个长度为 <code>(2^32)*2</code> 的数组，遍历所有数，<br>当遍历到第 1 次的时候，把 <code>bitArr[num*2+1]</code> 和 <code>bitArr[num*2]</code> 设置为 <code>01</code><br>当遍历到第 2 次的时候，把 <code>bitArr[num*2+1]</code> 和 <code>bitArr[num*2]</code> 设置为 <code>10</code><br>当遍历到第 3 次的时候，把 <code>bitArr[num*2+1]</code> 和 <code>bitArr[num*2]</code> 设置为 <code>11</code><br>之后无论遍历到多少次，就不做任何操作。</p><p>所有数遍历完成了之后，重新遍历，如果发现 <code>bitArr[num*2+1]</code> 和 <code>bitArr[num*2]</code> = <code>10</code> 就是出现了两次</p><h2 id="分块处理"><a class="anchor" href="#分块处理">#</a> 分块处理</h2><p>如果文件实在太大 ，无法在内存中放下，则需要考虑将大文件分成若干小块，先处理每个块，最后再逐步得到想要的结果，这种方式也叫做外部排序。这样需要遍历全部序列至少两次，是典型的用时间换空间的方法，</p><h3 id="4-从40个亿中产生一个不存在的整数限制内存为10mb"><a class="anchor" href="#4-从40个亿中产生一个不存在的整数限制内存为10mb">#</a> 4. 从 40 个亿中产生一个不存在的整数，限制内存为 10MB</h3><p>可行性分析，没办法使用位图。</p><p>40 亿个数需要 500MB，10MB 空间的话至少分成 50 块，一般都是按照 2 的整数倍来划分，所以我们划分成 64 块。</p><p><code>(2^32)</code> 约 40 亿 平均分成 64 个区间，每个区间的数量为 <code>(2^26)</code> 个</p><p>具体流程为：</p><ol><li>第一次遍历，创建一个长度为 64 的数组，用于统计区间 <code>i</code> 上的数有多少；<br>遍历到的数除以 <code>(2^26)</code> 得到对应的区间，之后对应的区间数组的统计值 + 1；<br>遍历完所有数之后，必然有某个区间的数字小于 <code>(2^26)</code> 。</li><li>找到这个区间，假设这个区间为 <code>partNum</code> ，然后第二次遍历。申请长度为 <code>(2^26)</code> 的位数组。<br>遍历到的数除以 <code>(2^26)</code> ，只处理商为 <code>partNum</code> 的值， <code>num/(2^26)==partNum</code><br>遍历完所有数之后，在位数组内必然存在有个值没被设置为 1</li></ol><h3 id="5-用-2gb-内存在-20-亿个整数中找到出现次数最多的数"><a class="anchor" href="#5-用-2gb-内存在-20-亿个整数中找到出现次数最多的数">#</a> 5. 用 2GB 内存在 20 亿个整数中找到出现次数最多的数</h3><p>题目要求：有一个包含 20 亿个全是 32 位整数的大文件，在其中找到出现次数最多的数。<br>要求，内存限制为 2GB。</p><p>可行性分析，直接读到内存里，使用哈希表。假设 哈希表的 key 是 32 位 int 占 4B 内存，哈希表的 value 是 32 位 int 占 4B 内存，一条不重复的记录占用 8B，如果哈希表的记录为 20 亿个，占用内存 <code>2000000000*8/1000/1000/1000 = 16GB</code></p><p>所以我们需要把这 20 亿个数通过哈希函数分成不同的小文件。这边我们分成 16 个小文件。相同的数通过同一个哈希函数之后，都会落入相同的文件中。</p><p>具体流程为：</p><ol><li>遍历 20 亿个数，根据哈希函数算出哈希值，然后对 16 取模，进入到不同的小文件中。</li><li>找到每个小文件中出现最多的数，对这几个数进行对比，找到出现最多的数。</li></ol><h3 id="6-对20gb文件进行排序"><a class="anchor" href="#6-对20gb文件进行排序">#</a> 6. 对 20GB 文件进行排序</h3><p>题目要求：假设你有一个 20GB 的文件，每行一个字符串，请说明如何对这个文件进行排序？</p><p>我们将文件划分成一些块，每块大小是 xMB，x 就是可用内存的大小，例如 1GB 一块，那我们就可以将文件分为 20 块。我们先对每块进行排序，然后再逐步合并。这时候我们可以使用两两归并，也可以使用堆排序策略将其逐步合并成一个。</p><h3 id="7从100-亿个-url中查找的问题"><a class="anchor" href="#7从100-亿个-url中查找的问题">#</a> 7. 从 100 亿个 URL 中查找的问题</h3><p>题目要求：有一个包含 100 亿个 URL 的大文件，假设每个 URL 占用 64B，请找出其中所有重复的 URL。</p><p>可行性分析，所有文件占用存储大小为 <code>10000000000*64/1000/1000/1000 = 640GB</code></p><p>同上，我们需要大文件通过哈希函数拆分成小文件，然后再进行处理。</p><p>比如拆成 128 个小文件，如果哈希函数足够优秀的话，每个文件约 5GB</p><p>后续流程略</p><h2 id="堆"><a class="anchor" href="#堆">#</a> 堆</h2><p>如果在超大数据中找第 K 大、第 K 小，K 个最大、K 个最小，则特别适合使用堆来做。</p><p>而且将超大数据换成流数据也可以，而且几乎是唯一的方式，口诀就是 “查小用大堆，查大用小堆”</p><h3 id="8-从100-亿个-url中找到出现次数-top-100的url"><a class="anchor" href="#8-从100-亿个-url中找到出现次数-top-100的url">#</a> 8. 从 100 亿个 URL 中找到出现次数 Top 100 的 URL</h3><p>同上，将大文件拆分成小文件之后。我们可以把不同的小文件的 top100 进行处理合并处理，直到合并完所有的 top100。</p><p>合并方法使用小顶堆来实现，</p><h3 id="9-从10亿数字中寻找最小的100万个数字"><a class="anchor" href="#9-从10亿数字中寻找最小的100万个数字">#</a> 9. 从 10 亿数字中寻找最小的 100 万个数字</h3><p>为前 100 万个数字创建一个大顶堆，最大元素位于堆顶。</p><p>然后，遍历整个序列，只有比堆顶元素小的才允许插入堆中，并删除原堆的最大元素。</p><p>之后继续遍历剩下的数字，最后剩下的就是最小的 100 万个。</p><div class="tags"><a href="/tags/dataStructure/" rel="tag"><i class="ic i-tag"></i> 数据结构</a> <a href="/tags/algorithm/" rel="tag"><i class="ic i-tag"></i> 算法</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2025-08-05 20:50:32" itemprop="dateModified" datetime="2025-08-05T20:50:32+08:00">2025-08-05</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Twelveeee <i class="ic i-at"><em>@</em></i>十二的编程笔记</li><li class="link"><strong>本文链接：</strong> <a href="https://blog.twelveeee.top/2023/AlgorithmCamp2023/15_BigData/" title="15 - 大规模数据场景">https://blog.twelveeee.top/2023/AlgorithmCamp2023/15_BigData/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/AlgorithmCamp2023/14_Heap/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;twelveeee-note.oss-cn-beijing.aliyuncs.com&#x2F;Image&#x2F;img&#x2F;bgimg_68.webp" title="14-堆"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 算法训练 2023</span><h3>14-堆</h3></a></div><div class="item right"><a href="/2023/Go/Lib/time/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;twelveeee-note.oss-cn-beijing.aliyuncs.com&#x2F;Image&#x2F;img&#x2F;bgimg_37.webp" title="Go 标准库源码解析-Time"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Lib</span><h3>Go 标准库源码解析-Time</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%A7%E8%A7%84%E6%A8%A1%E6%95%B0%E6%8D%AE%E5%9C%BA%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">大规模数据场景</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8D%E5%AD%98%E5%82%A8"><span class="toc-number">1.1.</span> <span class="toc-text">位存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A84kb%E5%86%85%E5%AD%98%E6%9F%A5%E6%89%BE%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.</span> <span class="toc-text">1. 使用 4KB 内存查找重复元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%8E40%E4%B8%AA%E4%BA%BF%E4%B8%AD%E6%89%BE%E5%88%B0%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%95%B4%E6%95%B0"><span class="toc-number">1.1.2.</span> <span class="toc-text">2. 从 40 个亿中找到一个不存在的整数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-40-%E4%BA%BF%E4%B8%AA%E6%95%B0%E4%B8%AD%E6%89%BE%E5%88%B0%E5%87%BA%E7%8E%B0%E4%B8%A4%E6%AC%A1%E7%9A%84%E6%95%B0"><span class="toc-number">1.1.3.</span> <span class="toc-text">3. 40 亿个数中找到出现两次的数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%9D%97%E5%A4%84%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">分块处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BB%8E40%E4%B8%AA%E4%BA%BF%E4%B8%AD%E4%BA%A7%E7%94%9F%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%95%B4%E6%95%B0%E9%99%90%E5%88%B6%E5%86%85%E5%AD%98%E4%B8%BA10mb"><span class="toc-number">1.2.1.</span> <span class="toc-text">4. 从 40 个亿中产生一个不存在的整数，限制内存为 10MB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%94%A8-2gb-%E5%86%85%E5%AD%98%E5%9C%A8-20-%E4%BA%BF%E4%B8%AA%E6%95%B4%E6%95%B0%E4%B8%AD%E6%89%BE%E5%88%B0%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0%E6%9C%80%E5%A4%9A%E7%9A%84%E6%95%B0"><span class="toc-number">1.2.2.</span> <span class="toc-text">5. 用 2GB 内存在 20 亿个整数中找到出现次数最多的数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%AF%B920gb%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F"><span class="toc-number">1.2.3.</span> <span class="toc-text">6. 对 20GB 文件进行排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E4%BB%8E100-%E4%BA%BF%E4%B8%AA-url%E4%B8%AD%E6%9F%A5%E6%89%BE%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.4.</span> <span class="toc-text">7. 从 100 亿个 URL 中查找的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86"><span class="toc-number">1.3.</span> <span class="toc-text">堆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E4%BB%8E100-%E4%BA%BF%E4%B8%AA-url%E4%B8%AD%E6%89%BE%E5%88%B0%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0-top-100%E7%9A%84url"><span class="toc-number">1.3.1.</span> <span class="toc-text">8. 从 100 亿个 URL 中找到出现次数 Top 100 的 URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E4%BB%8E10%E4%BA%BF%E6%95%B0%E5%AD%97%E4%B8%AD%E5%AF%BB%E6%89%BE%E6%9C%80%E5%B0%8F%E7%9A%84100%E4%B8%87%E4%B8%AA%E6%95%B0%E5%AD%97"><span class="toc-number">1.3.2.</span> <span class="toc-text">9. 从 10 亿数字中寻找最小的 100 万个数字</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2023/AlgorithmCamp2023/01_linkList/" rel="bookmark" title="01-链表">01-链表</a></li><li><a href="/2023/AlgorithmCamp2023/02_linkList_reverse/" rel="bookmark" title="02-链表翻转">02-链表翻转</a></li><li><a href="/2023/AlgorithmCamp2023/03_array/" rel="bookmark" title="03-数组和双指针思想">03-数组和双指针思想</a></li><li><a href="/2023/AlgorithmCamp2023/04_stack/" rel="bookmark" title="04-栈">04-栈</a></li><li><a href="/2023/AlgorithmCamp2023/05_queue/" rel="bookmark" title="05-队列和哈希">05-队列和哈希</a></li><li><a href="/2023/AlgorithmCamp2023/06_binaryTree/" rel="bookmark" title="06&07-二叉树遍历">06&07-二叉树遍历</a></li><li><a href="/2023/AlgorithmCamp2023/08_binaryTreeDFS/" rel="bookmark" title="08-二叉树DFS">08-二叉树DFS</a></li><li><a href="/2023/AlgorithmCamp2023/09_binarySearch/" rel="bookmark" title="09-二分查找">09-二分查找</a></li><li><a href="/2023/AlgorithmCamp2023/10_QuickSort/" rel="bookmark" title="10-快速排序">10-快速排序</a></li><li><a href="/2023/AlgorithmCamp2023/11_BitOperations/" rel="bookmark" title="11-位运算">11-位运算</a></li><li><a href="/2023/AlgorithmCamp2023/12_String/" rel="bookmark" title="12-字符串">12-字符串</a></li><li><a href="/2023/AlgorithmCamp2023/13_Number/" rel="bookmark" title="13-数字">13-数字</a></li><li><a href="/2023/AlgorithmCamp2023/14_Heap/" rel="bookmark" title="14-堆">14-堆</a></li><li class="active"><a href="/2023/AlgorithmCamp2023/15_BigData/" rel="bookmark" title="15-大规模数据场景">15-大规模数据场景</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Twelveeee" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Twelveeee</p><div class="description" itemprop="description">十二的编程笔记</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">119</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">30</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">26</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R3ZWx2ZWVlZQ==" title="https:&#x2F;&#x2F;github.com&#x2F;twelveeee"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnR3ZWx2ZWVlZTEyQGdtYWlsLmNvbQ==" title="mailto:twelveeee12@gmail.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><span class="exturl" data-url="aHR0cHM6Ly93d3cudHJhdmVsbGluZ3MuY24vZ28uaHRtbA=="><i class="ic i-paper-plane"></i>开往</span></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/AlgorithmCamp2023/14_Heap/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/Go/Lib/time/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/" title="分类于 数据结构">数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/%E9%98%9F%E5%88%97/" title="分类于 队列">队列</a></div><span><a href="/2020/DataStructure/Queue/chain%20queue/" title="链队列">链队列</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Linux%E5%9F%BA%E7%A1%80/" title="分类于 Linux 基础">Linux 基础</a></div><span><a href="/2020/Linux/Linux%20commands%20that%20novices%20must%20master/" title="新手必须掌握的Linux命令">新手必须掌握的Linux命令</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/" title="分类于 数据结构">数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/%E6%95%B0%E7%BB%84/" title="分类于 数组">数组</a></div><span><a href="/2020/DataStructure/Array/array/" title="数组">数组</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Project/" title="分类于 Project">Project</a></div><span><a href="/2024/Project/copilot-gpt4-service/" title="搭建使用github copilot的 ChatGPT Next Web">搭建使用github copilot的 ChatGPT Next Web</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/" title="分类于 数据结构">数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/%E7%9F%A9%E9%98%B5/" title="分类于 矩阵">矩阵</a></div><span><a href="/2020/DataStructure/Matrix/sparse%20matrix/" title="矩阵的压缩存储">矩阵的压缩存储</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/GO/" title="分类于 GO">GO</a></div><span><a href="/2025/Go/go_version_control/" title="golang 多版本环境控制">golang 多版本环境控制</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Linux%E5%9F%BA%E7%A1%80/" title="分类于 Linux 基础">Linux 基础</a></div><span><a href="/2020/Linux/intro%20copy/" title="什么是操作系统">什么是操作系统</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/networkPrinciple/" title="分类于 网络原理">网络原理</a></div><span><a href="/2020/NetworkPrinciples/intro/" title="网络原理概述">网络原理概述</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/" title="分类于 数据结构">数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/dataStructure/%E6%A0%88/" title="分类于 栈">栈</a></div><span><a href="/2020/DataStructure/Stack/sequential%20stack/" title="顺序栈">顺序栈</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computerScience/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computerScience/Linux%E5%9F%BA%E7%A1%80/" title="分类于 Linux 基础">Linux 基础</a></div><span><a href="/2020/Linux/Daily%20maintenance%20of%20Linux/" title="Linux系统的日常运维">Linux系统的日常运维</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Twelveeee @ Twelveeee</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">613k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">9:17</span></div><div class="beian-by"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener noreferrer">闽ICP备20004781号</a></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/AlgorithmCamp2023/15_BigData/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=default,fetch"></script><script src="//fastly.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?30195a9a0f4d22cd45e9d770a10c683f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-F27X623LWT"></script><script data-pjax>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-F27X623LWT")</script>--></body></html>